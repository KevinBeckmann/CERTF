<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Certificados Técnicos</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Dancing+Script&family=Roboto:wght@400;700&family=Playfair+Display:wght@400;700&display=swap');

        :root {
            --print-width: 210mm;
            --print-height: 297mm;
            --text-letter-spacing: 0px;
            --text-word-spacing: 0px;
        }

        body {
            background-color: #2c3e50;
            margin: 0;
            display: flex;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: white;
        }

        /* Painel de Controle (Esquerda) */
        .admin-panel {
            width: 500px;
            padding: 30px;
            background-color: #1a252f;
            height: 100vh;
            box-shadow: 2px 0 10px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            overflow-y: auto;
        }

        h2 { border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-top: 0; }

        .form-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-size: 14px; color: #bdc3c7; }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            background: #2c3e50;
            border: 1px solid #34495e;
            color: white;
            border-radius: 4px;
            box-sizing: border-box;
            font-family: inherit;
        }

        textarea {
            resize: vertical;
        }

        .form-row {
            display: flex;
            gap: 10px;
        }
        .form-row > * { flex: 1; }

        .checkbox-group {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }
        .checkbox-group label {
            display: flex;
            align-items: center;
            font-size: 14px;
            color: #bdc3c7;
        }
        .checkbox-group input[type="checkbox"] {
            margin-right: 8px;
        }

        .btn-print {
            width: 100%;
            padding: 15px;
            background-color: #27ae60;
            color: white;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            font-size: 16px;
            transition: 0.3s;
        }
        .btn-print:hover { background-color: #2ecc71; }

        /* Área de Visualização (Direita) */
        .preview-area {
            flex-grow: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
            background-color: #34495e;
        }

        /* Estilo do Certificado (Baseado na Imagem Original) */
        .certificate {
            width: var(--print-width);
            height: var(--print-height);
            background-color: white;
            padding: 60px;
            position: relative;
            box-sizing: border-box;
            color: #333;
            text-align: center;
            box-shadow: 0 0 30px rgba(0,0,0,0.5);
            font-family: var(--cert-font-family, 'Montserrat', sans-serif);
        }

        .certificate::before {
            content: "";
            position: absolute;
            top: 20px; bottom: 20px; left: 20px; right: 20px;
            border: 1px solid #e0e0e0;
        }

        .watermark {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            opacity: 0.05;
            background-image: url('https://www.transparenttextures.com/patterns/circuit-board.png');
            pointer-events: none;
        }

        .cert-title {
            font-size: 32px;
            text-transform: uppercase;
            font-weight: 700;
            margin-top: 100px;
            letter-spacing: 2px;
            font-family: var(--title-font-family, 'Montserrat', sans-serif);
        }

        .cert-subtitle { 
            font-size: 18px; 
            margin-top: 40px; 
            font-family: var(--subtitle-font-family, 'Montserrat', sans-serif);
        }
        
        .cert-name {
            font-size: 42px;
            font-weight: 700;
            text-transform: uppercase;
            margin: 20px 0 40px;
            border-bottom: none;
            font-family: var(--name-font-family, 'Montserrat', sans-serif);
        }

        .cert-text {
            font-size: 16px;
            line-height: 1.8;
            max-width: 600px;
            margin: 0 auto 40px;
            white-space: pre-wrap;
            font-family: var(--text-font-family, 'Montserrat', sans-serif);
            text-align: var(--text-align, center);
            letter-spacing: var(--text-letter-spacing);
            word-spacing: var(--text-word-spacing);
        }

        .topics-heading {
            font-size: 18px;
            font-weight: 700;
            margin: 0 0 10px;
            text-align: center;
            font-family: var(--text-font-family, 'Montserrat', sans-serif);
        }

        .topics-list {
            list-style-type: disc;
            text-align: var(--list-align, left);
            margin: 10px auto 20px;
            max-width: 600px;
            padding-left: 40px;
            font-size: 16px;
            line-height: 1.8;
            font-family: var(--text-font-family, 'Montserrat', sans-serif);
            letter-spacing: var(--text-letter-spacing);
            word-spacing: var(--text-word-spacing);
        }

        .footer {
            position: absolute;
            bottom: 80px;
            width: calc(100% - 120px);
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            padding: 0 20px;
        }

        .footer.center {
            justify-content: center;
        }

        .signature-box { border-top: 1px solid #333; width: 200px; padding-top: 10px; }
        .signature-font { 
            font-family: 'Dancing Script', cursive; 
            font-size: 24px; 
            margin-bottom: -5px; 
        }

        .seal {
            width: 120px;
            height: 120px;
            background: radial-gradient(circle, #ffd700 0%, #ffed4e 30%, #ffd700 70%, #b8860b 100%);
            border-radius: 50%;
            border: 5px double #8a6d3b;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            color: #4a3a00;
            box-shadow: 
                0 4px 10px rgba(0,0,0,0.3),
                inset 0 2px 4px rgba(255,255,255,0.5),
                inset 0 -2px 4px rgba(0,0,0,0.5);
            position: relative;
            text-align: center;
            line-height: 1.2;
            font-family: 'Playfair Display', serif;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .seal::before {
            content: "";
            position: absolute;
            top: 10px; left: 10px; right: 10px; bottom: 10px;
            border-radius: 50%;
            border: 2px solid rgba(255,255,255,0.2);
        }

        /* Estilos para o Template de Excelência */
        .certificate.excellence {
            background-image: url('https://www.transparenttextures.com/patterns/cream-paper.png');
            padding: 30px;
            width: 900px;
            height: auto;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        }

        .border-outer {
            border: 2px solid #c5a059;
            padding: 10px;
            height: 100%;
        }

        .border-inner {
            border: 5px double #c5a059;
            padding: 60px 50px 100px 50px;
            text-align: center;
            position: relative;
        }

        .excellence-title {
            font-family: 'Playfair Display', serif;
            font-size: 52px;
            margin: 0;
            color: #2c2c2c;
            letter-spacing: 2px;
        }

        .divider {
            width: 120px;
            height: 2px;
            background: #c5a059;
            margin: 15px auto;
        }

        .excellence-subtitle {
            font-family: 'Playfair Display', serif;
            font-style: italic;
            font-size: 20px;
            color: #666;
            margin-top: 30px;
        }

        .excellence-name {
            font-size: 40px;
            font-weight: 600;
            color: #8e6d2f;
            margin: 25px 0;
            border-bottom: 1px solid #f0f0f0;
            display: inline-block;
            padding: 0 30px 5px 30px;
        }

        .excellence-description {
            font-size: 17px;
            line-height: 1.8;
            max-width: 650px;
            margin: 0 auto;
            color: #444;
        }

        .seal-container {
            position: absolute;
            bottom: 70px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 10;
        }

        .gold-seal {
            width: 110px;
            height: 110px;
            background: radial-gradient(circle, #e2c99d 0%, #c5a059 50%, #8e6d2f 100%);
            border-radius: 50%;
            position: relative;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .seal-content {
            border: 2px solid rgba(255,255,255,0.4);
            width: 85%;
            height: 85%;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: 'Playfair Display', serif;
            font-weight: bold;
            color: #4a3a00;
            text-shadow: 1px 1px 0px rgba(255,255,255,0.5), -1px -1px 0px rgba(0,0,0,0.5);
            text-align: center;
            overflow: visible;
            white-space: normal;
        }

        .large {
            font-size: 12px;
        }

        .small {
            font-size: 7px;
            line-height: 1;
            margin-top: 1px;
        }

        .ribbon {
            width: 35px;
            height: 70px;
            background: #8b0000;
            position: absolute;
            top: 80px;
            z-index: -1;
            clip-path: polygon(0% 0%, 100% 0%, 100% 100%, 50% 85%, 0% 100%);
        }

        .ribbon-left { transform: rotate(15deg) translateX(-25px); }
        .ribbon-right { transform: rotate(-15deg) translateX(25px); }

        .excellence-footer {
            margin-top: 130px;
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            position: relative;
        }

        .footer-item {
            width: 280px;
            text-align: center;
        }

        .sig-line {
            border-top: 1.5px solid #2c2c2c;
            margin-bottom: 8px;
        }

        .label-text {
            font-size: 12px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #555;
        }

        .value-text {
            font-family: 'Playfair Display', serif;
            font-size: 17px;
            margin-bottom: 8px;
            color: #222;
        }

        /* Regras de Impressão */
        @media print {
            .admin-panel { display: none; }
            .preview-area { padding: 0; background: none; }
            body { background: none; }
            .certificate { box-shadow: none; border: none; }
            .certificate.excellence { -webkit-print-color-adjust: exact; }
        }
    </style>
</head>
<body>

    <div class="admin-panel">
        <h2>Painel | Aliencell</h2>

        <div class="form-group">
            <label>Modelo do Certificado</label>
            <select id="certTemplate" onchange="updateCert()">
                <option value="padrao">Padrão</option>
                <option value="excelencia">Excelência</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>Formato do Certificado</label>
            <select id="certFormat" onchange="updateCert()">
                <option value="A4">A4 (210mm x 297mm)</option>
                <option value="Letter">Carta (8.5in x 11in)</option>
                <option value="Legal">Ofício (8.5in x 14in)</option>
                <option value="Custom">Personalizado</option>
            </select>
        </div>

        <div class="form-group" id="customSize" style="display: none;">
            <div class="form-row">
                <div>
                    <label>Largura (mm)</label>
                    <input type="number" id="customWidth" value="210" onchange="updateCert()">
                </div>
                <div>
                    <label>Altura (mm)</label>
                    <input type="number" id="customHeight" value="297" onchange="updateCert()">
                </div>
            </div>
        </div>
        
        <div class="form-group">
            <label>Nome do Aluno</label>
            <input type="text" id="inputName" value="John Appleman" oninput="updateCert()">
        </div>

        <div class="form-group">
            <label>Fonte do Título</label>
            <select id="titleFont" onchange="updateCert()">
                <option value="Montserrat">Montserrat</option>
                <option value="Roboto">Roboto</option>
                <option value="Playfair Display">Playfair Display</option>
            </select>
        </div>

        <div class="form-group">
            <label>Fonte do Nome</label>
            <select id="nameFont" onchange="updateCert()">
                <option value="Montserrat">Montserrat</option>
                <option value="Roboto">Roboto</option>
                <option value="Playfair Display">Playfair Display</option>
            </select>
        </div>

        <div class="form-group">
            <label>Fonte do Texto</label>
            <select id="textFont" onchange="updateCert()">
                <option value="Montserrat">Montserrat</option>
                <option value="Roboto">Roboto</option>
                <option value="Playfair Display">Playfair Display</option>
            </select>
        </div>

        <div class="form-group">
            <div class="form-row">
                <div>
                    <label>Espaçamento entre letras</label>
                    <select id="letterSpacing" onchange="updateCert()">
                        <option value="0px">Normal</option>
                        <option value="1px">1px</option>
                        <option value="2px">2px</option>
                        <option value="3px">3px</option>
                    </select>
                </div>
                <div>
                    <label>Espaçamento entre palavras</label>
                    <select id="wordSpacing" onchange="updateCert()">
                        <option value="0px">Normal</option>
                        <option value="2px">2px</option>
                        <option value="4px">4px</option>
                        <option value="6px">6px</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="form-group">
            <label>Alinhamento do Texto</label>
            <select id="textAlign" onchange="updateCert()">
                <option value="center">Centralizado</option>
                <option value="left">Esquerda</option>
                <option value="right">Direita</option>
                <option value="justify">Justificado</option>
            </select>
        </div>

        <div class="form-group">
            <label>Alinhamento da Lista</label>
            <select id="listAlign" onchange="updateCert()">
                <option value="left">Esquerda</option>
                <option value="center">Centralizado</option>
                <option value="justify">Justificado</option>
            </select>
        </div>

        <div class="checkbox-group">
            <label>
                <input type="checkbox" id="showSeal" checked onchange="updateCert()"> Mostrar Selo
            </label>
            <label>
                <input type="checkbox" id="showSignature" checked onchange="updateCert()"> Mostrar Assinatura
            </label>
            <label>
                <input type="checkbox" id="showDate" checked onchange="updateCert()"> Mostrar Data
            </label>
        </div>

        <!-- Campos específicos para Padrão -->
        <div id="padraoFields">
            <div class="form-group">
                <label>Texto do Certificado (Use &lt;b&gt; para negrito)</label>
                <textarea id="inputText" rows="12" oninput="updateCert()">concluiu com êxito o treinamento avançado em <b>Manutenção e Reparo de Ecossistema Apple</b>, abrangendo diagnóstico de hardw[...]

Principais Competências Validadas:
Reparo de Placas-mãe (Logic Boards) e análise de esquemáticos.
Substituição de periféricos (Telas, Baterias e componentes técnicos).
Diagnóstico avançado via software e restauração de sistemas.
Protocolos de segurança ESD (Descarga Eletrostática).</textarea>
            </div>
        </div>

        <!-- Campos específicos para Excelência -->
        <div id="excelenciaFields" style="display: none;">
            <div class="form-group">
                <label>Título do Certificado</label>
                <input type="text" id="inputTitleExcelencia" value="Certificado" oninput="updateCert()">
            </div>
            <div class="form-group">
                <label>Subtítulo</label>
                <input type="text" id="inputSubtitle" value="Este documento certifica solenemente que" oninput="updateCert()">
            </div>
            <div class="form-group">
                <label>Nome do Curso/Treinamento</label>
                <input type="text" id="inputCourse" value="[Nome do Curso ou Treinamento]" oninput="updateCert()">
            </div>
            <div class="form-group">
                <label>Descrição (Use [curso] para substituir pelo nome do curso)</label>
                <textarea id="inputDescription" rows="6" oninput="updateCert()">completou com sucesso todos os requisitos exigidos para a certificação de [curso], demonstrando elevado desempenho, competência técnica e compromisso inabalável com a excelência.</textarea>
            </div>
            <div class="form-group">
                <label>Texto da Assinatura</label>
                <input type="text" id="inputSignatureText" value="Assinado digitalmente" oninput="updateCert()">
            </div>
        </div>

        <div class="form-group">
            <label>Data de Emissão</label>
            <input type="text" id="inputDate" value="15 de Março de 2026" oninput="updateCert()">
        </div>

        <button class="btn-print" onclick="window.print()">Gerar PDF / Imprimir</button>
        <p style="font-size: 11px; color: #7f8c8d; margin-top: 20px;">Dica: Na tela de impressão, selecione "Salvar como PDF". Use &lt;b&gt;tags&lt;/b&gt; para texto em negrito.</p>
    </div>

    <div class="preview-area">
        <div class="certificate" id="cert-content">
            <!-- Conteúdo será gerado pelo JavaScript -->
        </div>
    </div>

    <script>
        function updateCert() {
            const template = document.getElementById('certTemplate').value;
            const certContent = document.getElementById('cert-content');

            // Mostra/esconde campos específicos
            document.getElementById('padraoFields').style.display = template === 'padrao' ? 'block' : 'none';
            document.getElementById('excelenciaFields').style.display = template === 'excelencia' ? 'block' : 'none';

            // Atualiza formato (aplica a ambos)
            const format = document.getElementById('certFormat').value;
            let width, height;
            if (format === 'A4') {
                width = '210mm';
                height = '297mm';
            } else if (format === 'Letter') {
                width = '8.5in';
                height = '11in';
            } else if (format === 'Legal') {
                width = '8.5in';
                height = '14in';
            } else if (format === 'Custom') {
                width = document.getElementById('customWidth').value + 'mm';
                height = document.getElementById('customHeight').value + 'mm';
            }
            document.documentElement.style.setProperty('--print-width', width);
            document.documentElement.style.setProperty('--print-height', height);
            document.getElementById('customSize').style.display = format === 'Custom' ? 'block' : 'none';

            // Atualiza fontes (aplica a ambos onde relevante)
            const titleFont = document.getElementById('titleFont').value;
            const nameFont = document.getElementById('nameFont').value;
            const textFont = document.getElementById('textFont').value;
            document.documentElement.style.setProperty('--title-font-family', titleFont + ', sans-serif');
            document.documentElement.style.setProperty('--name-font-family', nameFont + ', sans-serif');
            document.documentElement.style.setProperty('--text-font-family', textFont + ', sans-serif');

            // Atualiza espaçamentos e alinhamentos (aplica ao texto)
            const letterSpacing = document.getElementById('letterSpacing').value;
            const wordSpacing = document.getElementById('wordSpacing').value;
            document.documentElement.style.setProperty('--text-letter-spacing', letterSpacing);
            document.documentElement.style.setProperty('--text-word-spacing', wordSpacing);
            const textAlign = document.getElementById('textAlign').value;
            document.documentElement.style.setProperty('--text-align', textAlign);
            const listAlign = document.getElementById('listAlign').value;
            document.documentElement.style.setProperty('--list-align', listAlign);

            const showSeal = document.getElementById('showSeal').checked;
            const showSignature = document.getElementById('showSignature').checked;
            const showDate = document.getElementById('showDate').checked;

            if (template === 'padrao') {
                // Remove classe de excelência
                certContent.classList.remove('excellence');

                // Gera conteúdo padrão
                const name = document.getElementById('inputName').value;
                const date = document.getElementById('inputDate').value;
                const fullText = document.getElementById('inputText').value;
                const lines = fullText.split('\n').map(line => line.trim()).filter(line => line);
                let mainText = '';
                let competencies = [];
                let inCompetencies = false;
                for (let line of lines) {
                    if (line === 'Principais Competências Validadas:') {
                        inCompetencies = true;
                        continue;
                    }
                    if (inCompetencies) {
                        competencies.push(line);
                    } else {
                        mainText += line + ' ';
                    }
                }

                certContent.innerHTML = `
                    <div class="watermark"></div>
                    <div class="cert-title">Certificado de Excelência Técnica</div>
                    <p class="cert-subtitle">Certificamos que</p>
                    <div class="cert-name">${name.toUpperCase()}</div>
                    <div class="cert-text">${mainText.trim()}</div>
                    <div class="topics-heading">Principais Competências Validadas:</div>
                    <ul class="topics-list">${competencies.map(comp => `<li>${comp}</li>`).join('')}</ul>
                    <div class="footer" id="footer">
                        <div style="font-size: 12px;" id="displayDate" style="display: ${showDate ? 'block' : 'none'}">Data de Emissão: ${date}</div>
                        <div class="signature-box" id="signatureBox" style="display: ${showSignature ? 'block' : 'none'}">
                            <div class="signature-font">Instrutor Técnico</div>
                            <div style="font-size: 10px; text-transform: uppercase;">Assinatura</div>
                        </div>
                        <div class="seal" id="seal" style="display: ${showSeal ? 'flex' : 'none'}">ALIENCELL<br>EXCELLENCE<br>APPLE</div>
                    </div>
                `;
            } else if (template === 'excelencia') {
                // Adiciona classe de excelência
                certContent.classList.add('excellence');

                // Gera conteúdo de excelência
                const title = document.getElementById('inputTitleExcelencia').value;
                const subtitle = document.getElementById('inputSubtitle').value;
                const name = document.getElementById('inputName').value;
                const course = document.getElementById('inputCourse').value;
                const description = document.getElementById('inputDescription').value.replace(/\[curso\]/g, '<strong>' + course + '</strong>');
                const signatureText = document.getElementById('inputSignatureText').value;
                const date = document.getElementById('inputDate').value;

                certContent.innerHTML = `
                    <div class="border-outer">
                        <div class="border-inner">
                            <h1 class="excellence-title">${title}</h1>
                            <div class="divider"></div>
                            <p style="letter-spacing: 8px; font-weight: 300; margin-top: -5px; font-size: 14px;">DE EXCELÊNCIA E MÉRITO</p>
                            <p class="excellence-subtitle">${subtitle}</p>
                            <div class="excellence-name">${name}</div>
                            <p class="excellence-description">${description}</p>
                            <div class="seal-container" id="sealContainer" style="display: ${showSeal ? 'flex' : 'none'}">
                                <div class="ribbon ribbon-left"></div>
                                <div class="ribbon ribbon-right"></div>
                                <div class="gold-seal">
                                    <div class="seal-content">
                                        <div class="large">ALIENCELL</div>
                                        <div class="small">REPAROS AVANÇADOS APPLE</div>
                                    </div>
                                </div>
                            </div>
                            <div class="excellence-footer">
                                <div class="footer-item date-side" style="display: ${showDate ? 'block' : 'none'}">
                                    <div class="value-text">${date}</div>
                                    <div class="sig-line"></div>
                                    <div class="label-text">Data de Emissão</div>
                                </div>
                                <div class="footer-item sign-side" style="display: ${showSignature ? 'block' : 'none'}">
                                    <div class="value-text" style="font-style: italic; color: #777;">${signatureText}</div>
                                    <div class="sig-line"></div>
                                    <div class="label-text">Assinatura</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Centraliza footer padrão se necessário
            if (template === 'padrao') {
                const footer = document.getElementById('footer');
                if (!showSignature && !showDate) {
                    footer.classList.add('center');
                } else {
                    footer.classList.remove('center');
                }
            }
        }

        // Inicializa
        updateCert();
    </script>
</body>
</html>
